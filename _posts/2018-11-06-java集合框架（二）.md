---
layout:     post
title:      java 集合框架（二）
subtitle:   由 Collection 接口说开
date:       2018-11-06
author:     Alessio
header-img: img/PostBack_03.jpg
catalog: true
tags:
    - java
    - 集合框架
---

## Collection 接口

在对集合框架做完总体描述之后，我们来详细的看一下 `Collection` 这个接口的内容。

在官方文档中，明确给出了核心的继承关系图，这里也包含了 `Map` 接口的核心继承关系

![The core collection interfaces](https://docs.oracle.com/javase/tutorial/figures/collections/colls-coreInterfaces.gif)

另外。在声明一个 `Collection` 对象的时候，我们使用**泛型**来完成类型的规定 —— 这可以让编译器在程序的编译和运行阶段检查出代码的错误之处

> 有关 `泛型` 的内容 可以移步 [**浅谈 java 泛型**](https://zjianru.top/2018/10/31/%E6%B3%9B%E5%9E%8B/)

在后续的内容中，我们只讨论如何有效的使用一般接口 —— 当差不多了解完这些接口，我们对集合框架的内容就已经基本掌握了

## 接口方法浅析

`Collection` 接口是一个总接口，只规定了一系列的抽象方法，并由另外的子类完成各自的实现：

![Collection 接口方法图](https://raw.githubusercontent.com/Zjianru/zjianru.github.io/master/img/Collection%20%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95%E5%9B%BE.png)

在图中可以看到两个操作数组的方法：

```java
Object[] toArray();
<T> T[] toArray(T[] a);
```

两个关于流操作（Stream）的方法（ In JDK 8 and later ）：

```java
default Stream<E> stream() {
    return StreamSupport.stream(spliterator(), false);
}   

default Stream<E> parallelStream() {
    return StreamSupport.stream(spliterator(), true);
}
```

包括：

- 添加 Collection 容器内元素的方法，他们旨在向容器内添加元素，保证完成调用之后将会包含指定的元素 —— Collection 会发生变化。如果改变，则会返回 True


```java
boolean add(E e);
boolean addAll(Collection<? extends E> c);
```


- 删除 Collection 容器内元素的方法，他们旨在从 Collection 中删除指定元素，如果它包含要开始的元素，并且如果 Collection 被修改为结果则返回 true

```java
boolean remove(Object o);

boolean removeAll(Collection<?> c);

default boolean removeIf(Predicate<? super E> filter) {
    Objects.requireNonNull(filter);
    boolean removed = false;
    final Iterator<E> each = iterator();
    while (each.hasNext()) {
        if (filter.test(each.next())) {
            each.remove();
            removed = true;
        }
    }
    return removed;
}
```
### 遍历集合

关于遍历集合，我们有三种方式，在这里我们只做简单的介绍：

1. 获取流并使用聚合操作
2. 使用 for 循环 或 for-each 循环
3. 使用迭代器

#### 获取流并使用聚合操作

在 JDK8 之后,官方推荐的方式便是使用流完成对集合的遍历

聚合操作 ( `perform aggregate operations` ) 通常与 lambda 表达式结合使用，以使用较少的代码行使编程更具表现力。这是 JDK8 添加的新特性

以下代码按顺序遍历一组形状并打印出红色对象
```java
myShapesCollection.stream()
.filter(e -> e.getColor() == Color.RED)
.forEach(e -> System.out.println(e.getName()));
```
或者用这样的方式，可以以多线程的方式完成操作
```java
myShapesCollection.parallelStream()
.filter(e -> e.getColor() == Color.RED)
.forEach(e -> System.out.println(e.getName()));
```