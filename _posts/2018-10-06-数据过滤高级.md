---
layout:     post
title:      数据过滤高级 -- 使用通配符
subtitle:   from -- SQL必知必会 
date:       2018-10-06
author:     Alessio
header-img: img/PostBack_04.jpg
catalog: true
tags:
    - SQL
---
### 一点概念

我们在之前介绍了操作符，用来过滤已知值。但是我们怎样来对未知值过滤呢？

比如我们要查找所有产品名中包含文本 beans 的产品，使用操作符似乎并不能帮助我们完成

而使用通配符，可以使我们完成一个特定的数据搜索模式，进而完成上述要求

- 通配符 ( `wlidcard` ) :用来匹配值的一部分的份特殊字符
- 搜索模式 ( `search pattern`) : 由字面值、通配符或者两者组合而成的搜索条件

**通配符搜索只能用于文本字段**

### `LIKE` 通配符

`LIKE` 操作符指示 DBMS ，后跟的搜索模式利用通配符匹配，而不是简单的利用相等匹配进行比较

#### `Tips`
谓词 ( `predicate` )：操作符什么时候才不是操作符？答案是，当它作为谓词的时候

从技术上说， `LIKE` 就是谓词

### 百分号通配符 `%`

最常用的通配符是百分号 `%` 在搜索传中，`%` 表示任何字符出现任意次数

如下的实例，我们将找出所有以 fish 为开头的数据

```sql
SELECT
    id,name
FROM
    products
WHERE
    name
        LIKE 'fish%';
```
通配符也可以在搜索模式中的任意位置使用，也可使用多个

如下的例子，我们将找出任何位置上包含文本 fish 的值
```sql
SELECT
    id,name
FROM
    products
WHERE
    name
        LIKE '%fish%';

```
#### `Tips`
1. 通配符并非可以匹配任何东西，例如 `NULL` 。子句 ` WHERE name LIKE '%' `不会匹配名称为 NULL 的行
2. 注意搜索模式内容的大小写

### 下划线通配符 `_`
下划线通配符的用途和`%` 一样，但他只能匹配单个字符，而非多个字符，看如下示例
```sql
SELECT
    id,name
FROM
    products
WHERE
    name
        LIKE '_fish';
```
#### `Tips`
DB2 不支持下划线通配符

### 方括号通配符 `[ ]`
方括号通配符用来指定一个字符集，他必须匹配指定位置（通配符的位置）的一个字符

如下示例：

```sql
SELECT
    contact
FROM
    customers
WHERE
    contact 
        LIKE '[JM]%'
ORDER BY
    contact;
```
在这里，我们的匹配模式为 `'[JM]%'` 使用了两个不同的匹配符

`[JM]` 匹配方括号中任意一个字符，他也只能匹配单个字符。

`[JM]` 之后的 `%` 通配符匹配第一个字符后的任意数目的字符开头的记录

方括号通配符可以使用前缀字符 `^` 脱字号来进行否定表示，如下示例：
```sql
SELECT
    contact
FROM
    customers
WHERE
    contact 
        LIKE '[^JM]%'
ORDER BY
    contact;
```
#### `Tips`

并不是的所有的 DBMS 都支持方括号通配符，需要查看相应的文档再确定

### 使用通配符的技巧

- 不要过度使用通配符。使用通配符会有性能上的损失
- 在使用的时候，不要将通配符放在搜索模式的开始处 —— 也是为了性能
- 注意通配符的语法